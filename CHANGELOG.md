# 📝 PowerShell 脚本管理工具 更新日志 (CHANGELOG)

> **⚠️ 致后续开发 AI 的规范说明**：
> 1. 请在每次对本项目进行功能新增、逻辑修改或界面优化后，务必在本文件中记录更新内容。
> 2. 更新记录应包含：日期、版本号（如适用）以及具体的修改条目。
> 3. 保持格式一致性，以便用户和其他 AI 能够清晰追踪项目演进。

---

## [2026-03-01] - 交互革命：引入图形化界面 (GUI)

### ✨ 新增功能 (ScriptManagerGUI.ps1)
- **可视化管理**：推出了基于 WPF 的图形化管理工具 `ScriptManagerGUI.ps1`。
- **直观列表展示**：通过 `ListView` 实时展示脚本名称、版本、创建时间及功能描述。
- **一键操作面板**：集成了运行、修改、新增、删除及版本回滚的图形化按钮。
- **实时详情预览**：选中脚本后可直接在侧边栏查看完整的功能介绍和路径信息。

### 🛠️ 架构适配
- **逻辑复用**：成功将 `ScriptManager.ps1` 中的环境初始化、元数据管理和版本备份逻辑迁移至 GUI 版本。
- **多线程运行**：脚本运行操作改为通过 `Start-Process` 在新窗口执行，确保 GUI 界面不会在脚本执行期间阻塞。
- **交互增强**：引入了 `Microsoft.VisualBasic` 命名空间，为新增脚本等操作提供了标准的输入对话框。

### 📄 文档同步
- **README.md**：在项目结构中新增了 GUI 工具的入口说明。

---

## [2026-03-01] - 交互优化：统一导航逻辑

### 🎨 交互逻辑变更 (ScriptManager.ps1)
- **统一导航按键**：现在所有菜单的“退出”或“返回”逻辑均统一为 `N` (或 `n`)，移除了之前的 `0` 键操作。
- **新增脚本快捷键**：将主界面的“新增脚本”操作按键由 `N` 变更为 `A` (或 `a`)，避免与导航键冲突。
- **全系统同步**：更新了 `Edit-Script`, `Remove-Script`, `Rollback-ScriptVersion`, `Run-Script` 等所有子功能模块的退出逻辑。

### 📄 文档同步
- **CONTRIBUTING.md**：更新了开发工作流说明，反映了最新的按键逻辑和两级菜单操作。
- **README.md**：重构了“操作说明”部分，清晰展示了当前的交互流程。

---

## [2026-03-01] - 架构重构：以脚本为中心的交互流

### 🏗️ 架构重构 (ScriptManager.ps1)
- **主循环逻辑重组**：启动工具后直接展示所有脚本列表，并支持通过序号直接选择脚本或输入 `N` 新增脚本。
- **引入二级操作菜单**：选中特定脚本后，进入专属操作菜单（运行、修改、版本回滚、删除），显著提升了操作效率。
- **参数化函数改造**：重构了 `Edit-Script`, `Remove-Script`, `Rollback-ScriptVersion`, `Run-Script` 等核心函数，支持直接接收脚本对象参数，消除了冗余的选择步骤。

### 🎨 UI 与交互优化
- **详情区域扩容**：重构了 `ScriptManagerGUI.ps1` 的右侧布局，将脚本详情区域由固定高度改为自动填充剩余空间，大幅提升了长描述脚本的可读性。
- **布局微调**：优化了控件间的间距，使整体界面更具呼吸感。

---

## [2026-02-28] - 规范升级：交互设计准则

### 📄 规范更新 (CONTRIBUTING.md)
- **新增交互设计规范**：明确规定所有业务脚本必须包含 `do...while` 循环逻辑。
- **强制运行后询问**：要求脚本执行完毕后询问用户是否再次运行，且确认提示默认值必须设为 **Y**。
- **自检清单同步**：在发布前自检清单中新增了对“循环运行逻辑”的检查项。

---

## [2026-02-28] - 文档专业化与描述优化

### 📄 文档增强
- **Zip_to_img_to_pdf.ps1**：
    - 重构了脚本头部注释，引入了标准的 `.SYNOPSIS`, `.DESCRIPTION`, `.PARAMETER` 等帮助文档格式。
    - 升级了脚本启动时的功能展示界面，使用了更专业的术语（如“文档自动化流水线”、“智能路径管理”、“高质合成引擎”）。
- **元数据与自述文件**：
    - 更新了 `ScriptMetaData.json` 和 `README.md` 中的脚本描述，使其更符合工业级自动化工具的定位。
    - 版本号微调至 v3.1。

---

## [2026-02-28] - 脚本修复与版本演进 (Count_files.ps1 v4.1)

### 🛠️ 故障修复
- **修复 -join 参数错误**：解决了 v4.0 版本中 `Sort-Object` 误用 `-join` 参数导致的脚本崩溃问题（`A parameter cannot be found that matches parameter name 'join'`）。
- **逻辑优化**：修正了预设类型展示的字符串拼接逻辑，确保在 PowerShell 5.1 环境下的兼容性。

### 🔄 版本回滚记录
- **紧急回滚**：在发现 v4.0 故障后，第一时间将 `Scripts/Count_files.ps1` 手动回滚至 v3 版本以保证可用性。
- **重新发布**：在修复 Bug 后，将脚本更新至 v4.1 并同步更新元数据。

---

## [2026-02-28] - 脚本功能增强 (Count_files.ps1)

### ✨ 新增功能
- **多类型统计支持**：`Count_files.ps1` 现在支持用户指定多种文件类型进行统计。
- **预设简写映射**：引入了 `pdf`, `doc`, `ppt`, `xls`, `img`, `zip`, `txt` 等常用类型的快速选择。
- **自定义扩展名**：支持用户直接输入如 `.py` 或 `java` 等自定义扩展名。
- **交互优化**：增加了更友好的输入提示和格式化的统计结果展示（按数量降序排列）。

### 🛠️ 版本管理
- **手动备份触发**：按照 `CONTRIBUTING.md` 规范，在修改前已将 v3 版本备份至 `VersionBackup/`。
- **元数据同步**：更新了 `ScriptMetaData.json`，版本号提升至 v4。

---

## [2026-02-28] - 建立开发与操作规范 (CONTRIBUTING)

### 📄 文档规范化
- **创建 CONTRIBUTING.md**：制定了详细的开发工作流，明确了管理工具核心与业务脚本的不同修改路径。
- **引入自检清单**：要求所有修改者（包括 AI）在发布前对照 CheckList 进行检查。
- **强制版本溯源**：强调必须通过 `ScriptManager.ps1` 进行脚本修改，以触发自动备份机制。

### 🔗 关联优化
- **README.md 更新**：在项目结构部分新增了对 `CONTRIBUTING.md` 的引用。

---

## [2026-02-28] - UI 统一化与架构重构

### 🎨 UI 统一化 (ScriptManager.ps1)
- **全局精美列表**：提取了通用的 `Show-FormattedScriptList` 函数，实现了全系统 UI 的高度统一。
- **覆盖所有模块**：现在“运行脚本”、“修改脚本”、“删除脚本”、“版本回滚”和“查看列表”均使用相同的精美卡片式展示界面。
- **交互优化**：在序号模式下增加了高亮显示，输入提示更加简洁直观。

### 🏗️ 架构重构
- **代码精简**：通过函数复用，删除了约 100 行冗余的列表展示代码，提升了脚本的可维护性。

---

## [2026-02-28] - 界面美化与功能增强

### 🎨 界面优化 (ScriptManager.ps1)
- **精美列表展示**：重构了“查看脚本列表”页面。
    - 增加了 Cyan/Yellow/Green 多色区分，提升视觉层次感。
    - 引入了 `----------------` 分隔线，使每个脚本的信息块（名称、版本、时间、介绍）独立且易读。
    - 使用了 Emoji 图标（📦, 🔢, 🕒, 🔍）增强交互感。

### ⚙️ 交互优化 (ScriptManager.ps1)
- **快捷返回机制**：在所有需要选择脚本的子菜单中，新增了“输入 0 或直接按回车”即可返回主菜单的功能，解决了用户误点选项后无法退出的痛点。
- **确认逻辑回滚**：应用户要求，为“删除脚本”和“版本回滚”操作重新添加了二次确认提示，防止误操作。
- **运行逻辑保持**：保持“运行脚本”直接启动的特性，追求执行效率。

### 📄 文档更新
- **创建更新日志 (CHANGELOG.md)**：正式引入版本追踪机制，并为后续 AI 开发制定了操作规范。
- **完善 README.md**：详细介绍了工具用法及内置脚本功能。

---

## [2026-02-28] - 功能扩展与体验优化

### ✨ 新增脚本
- **Push-ToGitHub.ps1**：实现一键初始化并推送文件夹至 GitHub 仓库。

### 🔄 流程优化
- **业务脚本循环化**：
    - 为 `Push-ToGitHub.ps1` 添加了循环处理逻辑。
    - 统一所有业务脚本运行后的“是否继续”询问，且**默认值设为 Y**。
- **默认值调整**：将全系统的 `Y/N` 确认提示默认值由 N 改为 Y。

---

## [2026-02-24] - 项目初始化

### 🏗️ 核心架构
- 实现 `ScriptManager.ps1` 主控程序。
- 建立基于 `ScriptMetaData.json` 的脚本元数据管理系统。
- 建立基于 `VersionBackup/` 的自动版本备份与回滚机制。
- 初始内置脚本：`Count_files.ps1`, `Zip_to_img_to_pdf.ps1`。
